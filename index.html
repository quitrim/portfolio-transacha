<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Site interactif complet</title>
<style>
html, body {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  background: white;
  overflow: hidden;
}
#container {
  position: absolute;
  width: 1920px;
  height: 1080px;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
}
.img-item {
  position: absolute;
  transform: translate(-50%, -50%);
  cursor: pointer;
  user-select: none;
}
#fond {
  width: 1920px;
  height: 1080px;
  object-fit: cover;
  left: 960px;
  top: 540px;
  transform: translate(-50%, -50%);
  z-index: 0;
}

/* Bouton inversé visuellement */
.inverted #invertToggle {
  filter: invert(100%);
}

body:not(.inverted) img.no-invert {
  filter: invert(0%);
}


body.inverted {
  filter: invert(100%);
}

img.no-invert {
  filter: invert(100%);
}

/* --- Empêche les images marquées .no-invert d'être inversées quand le body est inversé --- */
body.inverted img.no-invert {
  filter: invert(100%);
}



</style>
</head>

<body>

<div id="container">
  <img id="fond" src="images/fond.png" class="img-item">
</div>

<script>
const container = document.getElementById('container');
const params = new URLSearchParams(window.location.search);
const currentPage = parseInt(params.get("page")) || 13;

const data = [
  // Éléments fixes
  { base:"images/homme.png", hover:"images/homme1.png", x:1740.97, y:494.29, hoverX:1740.97, hoverY:494.29, z:1, pages:[1,2,3,4,5,6,7,8,9,10,11,12,13], goto:10 },
  { base:"images/livre.png", hover:"images/livre1.png", x:195.59, y:490.3, hoverX:189.90, hoverY:485.14, z:1, pages:[1,2,3,4,5,6,7,8,9,10,11,12,13], goto:11 },
  { base:"images/point.png", hover:"images/point1.png", x:862.18, y:987.47, hoverX:862.00, hoverY:1001.47, z:3, pages:[1,2,3,4,5,6,7,8,9,10,11,12,13], goto:12 },

  // Portfolio invisible par défaut
  { base:"images/portfolio1.png", hover:"images/portfolio.png", x:931.93, y:68.78, hoverX:931.93, hoverY:68.78, z:5, pages:[1,2,3,4,5,6,7,8,9,10,11,12], goto:1 },

  // Labos page 1
  { base:"images/fungilab.png", hover:"images/fungilab1.png", x:793.91, y:623.73, hoverX:772.84, hoverY:503.73, z:4, pages:[1], goto:5 },
  { base:"images/lowtechlab.png", hover:"images/lowtechlab1.png", x:899.74, y:567.73, hoverX:879.83, hoverY:444.16, z:3, pages:[1], goto:3 },
  { base:"images/drid.png", hover:"images/drid1.png", x:1002.68, y:509.33, hoverX:975.98, hoverY:391.79, z:2, pages:[1], goto:2 },
  { base:"images/milvi.png", hover:"images/milvi1.png", x:1103.57, y:456.33, hoverX:1068.44, hoverY:333.92, z:1, pages:[1], goto:4 },

  // Pages 2–5 : k72-k75 → pages 6-9
  { base:"images/k72.png", x:1446.4004, y:289.3719, z:6, pages:[2], goto:6 },
  { base:"images/tp2.png", x:982.4242, y:518.6119, z:1, pages:[2] },
  { base:"images/detail.png", x:1451.7153, y:443.2456, z:4, pages:[2], goto:6 },

  { base:"images/k73.png", x:1446.4004, y:289.3719, z:2, pages:[3], goto:7 },
  { base:"images/tp3.png", x:982.4242, y:518.6119, z:1, pages:[3] },
  { base:"images/detail.png", x:1451.7153, y:443.2456, z:4, pages:[3], goto:7 },



  { base:"images/k74.png", x:1446.4004, y:289.3719, z:5, pages:[4], goto:8 },
  { base:"images/tp4.png", x:982.4242, y:518.6119, z:1, pages:[4] },
  { base:"images/detail.png", x:1451.7153, y:443.2456, z:4, pages:[4], goto:8 },


  { base:"images/k75.png", x:1446.4004, y:289.3719, z:2, pages:[5], goto:9 },
  { base:"images/tp5.png", x:982.4242, y:518.6119, z:1, pages:[5] },
  { base:"images/detail.png", x:1451.7153, y:443.2456, z:4, pages:[5], goto:9 },

  

  // Pages finales 6–9 : boîte et nuage avec retour à page précédente
  { base:"images/boite6.png", x:1486.1633, y:289.3719, z:2, pages:[6], gotoPrev:2 },
  { base:"images/nu6.png",    x:1317.9226, y:289.3747, z:3, pages:[6] },
  { base:"images/p6s1.png",    x:550.27, y:359.8, z:1, pages:[6] },
  { base:"images/tp6.png",    x:1411.2405, y:93.69, z:1, pages:[6] },
  { base:"images/p6s2.png",    x:561.8658, y:722, z:1, pages:[6] },
  { base:"images/p6s4.png",    x:1525.1952, y:701.35, z:1, pages:[6] },
  { base:"images/p6s3.png",    x:1077.3786, y:716.13, z:1, pages:[6] },
  { base:"images/p6s5.png",    x:1006.9937, y:349.28, z:1, pages:[6] },
  
  
  { base:"images/boite7.png",  x:1486.1633, y:289.3719, z:2, pages:[7], gotoPrev:3 },
  { base:"images/nu7.png",    x:1317.9226, y:289.3747, z:5, pages:[7] },
  { base:"images/p7s1.png",    x:570, y:371, z:1, pages:[7] },
  { base:"images/p7s2.png",    x:869.2619, y:734.5, z:1, pages:[7] },
  { base:"images/p7s3.png",    x:1397.8326, y:678.3, z:1, pages:[7] },
  { base:"images/b0.png",    x:497.2546, y:768.6, z:1, pages:[7] },
  { base:"images/b1.png",    x:996.6583, y:373.8, z:1, pages:[7] },
  { base:"images/b2.png",    x:1165.6233, y:821.56, z:1, pages:[7] },
  { base:"images/tp7.png",    x:1411.2405, y:93.69, z:1, pages:[7] },
  

  { base:"images/boite8.png",  x:1486.1633, y:289.3719, z:2, pages:[8], gotoPrev:4 },
  { base:"images/nu8.png",   x:1317.9226, y:289.3747, z:5, pages:[8] },
  { base:"images/tp8.png",    x:1411.2405, y:93.69, z:1, pages:[8] },
  { base:"images/fp8.png",    x:932.522, y:532, z:1, pages:[8] },
   { base:"images/p81.png",    x:730, y:284, z:1, pages:[8] },
   { base:"images/p82.png",    x:427.7295, y:781, z:1, pages:[8] },
   { base:"images/p83.png",    x:1215.722, y:767.76, z:1, pages:[8] },


  { base:"images/boite9.png",  x:1486.1633, y:289.3719, z:2, pages:[9], gotoPrev:5 },
  { base:"images/nu9.png",    x:1317.9226, y:289.3747, z:1, pages:[9] },
  { base:"images/p9s1.png", x:616.2764 ,y:347.5776, z:2, pages:[9] },
  { base:"images/p9s2.png", x:602.7697, y:742.0771, z:2, pages:[9] },
  { base:"images/flab.png", x:1317.3113, y:721, z:2, pages:[9] },
  { base:"images/tp9.png",    x:1411.2405, y:93.69, z:1, pages:[9] },

  

  { base:"images/tsacha.png",    x:1411.2405, y:93.69, z:1, pages:[10] },

  { base:"images/t11.png",    x:1411.2405, y:93.69, z:1, pages:[11] },  

  { base:"images/p12titre.png",    x:1411.2405, y:93.69, z:1, pages:[12] },

  

  
];
// mapping hover filename -> image "o" à afficher + offsets/z
const hoverToO = {
  "drid1.png":       { src: "images/o3.png", xOffset: 10, yOffset: -210, z: 6 },
  "fungilab1.png":   { src: "images/o1.png", xOffset: 20, yOffset: -230, z: 6 },
  "lowtechlab1.png": { src: "images/o2.png", xOffset:30, yOffset: -210, z: 6 },
  "milvi1.png":      { src: "images/o4.png", xOffset: 60, yOffset: -170, z: 6 }
};

data.forEach(item => {
  if (!item.pages.includes(currentPage)) return;

  // Portfolio spécial (si tu as ce cas)
  if (item.base === item.hover) {
    const hover = document.createElement('img');
    hover.src = item.hover;
    hover.classList.add('img-item');
    hover.style.left = (item.hoverX ?? item.x) + 'px';
    hover.style.top = (item.hoverY ?? item.y) + 'px';
    hover.style.zIndex = item.z;
    hover.style.opacity = 0;
    container.appendChild(hover);

    hover.addEventListener('mouseover', () => { hover.style.opacity = 1; });
    hover.addEventListener('mouseout', () => { hover.style.opacity = 0; });
    hover.addEventListener('click', () => { window.location.search='?page=1'; });
    return;
  }

  // Création de l'image de base
  const base = document.createElement('img');
  base.src = item.base;
  base.classList.add('img-item');
  base.style.left = item.x + 'px';
  base.style.top = item.y + 'px';
  base.style.zIndex = item.z;
  container.appendChild(base);

  let hover = null;
  let oEl = null;

  if (item.hover) {
    // création de la hover
    hover = document.createElement('img');
    hover.src = item.hover;
    hover.classList.add('img-item');
    const hoverX = (typeof item.hoverX !== 'undefined') ? item.hoverX : item.x;
    const hoverY = (typeof item.hoverY !== 'undefined') ? item.hoverY : item.y;
    hover.style.left = hoverX + 'px';
    hover.style.top = hoverY + 'px';
    hover.style.zIndex = (item.z || 2) + 1;
    hover.style.display = 'none';
    container.appendChild(hover);

    // si mapping -> création de l'o correspondant
    const hoverFilename = item.hover.split('/').pop();
    const mapping = hoverToO[hoverFilename];
    if (mapping) {
      oEl = document.createElement('img');
      oEl.src = mapping.src;
      oEl.classList.add('img-item');
      const oX = hoverX + (mapping.xOffset || 0);
      const oY = hoverY + (mapping.yOffset || 0);
      oEl.style.left = oX + 'px';
      oEl.style.top = oY + 'px';
      oEl.style.zIndex = mapping.z || ((item.z || 2) + 2);
      oEl.style.display = 'none';
      container.appendChild(oEl);
    }

    // fonctions d'affichage / masquage
    const showHoverAndO = () => {
      base.style.display = 'none';
      hover.style.display = 'block';
      if (oEl) oEl.style.display = 'block';
    };
    const hideHoverAndO = () => {
      base.style.display = 'block';
      if (hover) hover.style.display = 'none';
      if (oEl) oEl.style.display = 'none';
    };

    // affichage quand on entre sur la base
    base.addEventListener('mouseenter', showHoverAndO);

    // gestion de la sortie : on vérifie relatedTarget pour ne pas masquer si on va vers l'autre élément
    const maybeHide = (e) => {
      const rt = e.relatedTarget;
      if (rt === hover || rt === oEl || rt === base) return; // on reste dans la zone → ne pas cacher
      hideHoverAndO();
    };

    hover.addEventListener('mouseleave', maybeHide);
    hover.addEventListener('mouseenter', showHoverAndO);

    if (oEl) {
      oEl.addEventListener('mouseleave', maybeHide);
      oEl.addEventListener('mouseenter', showHoverAndO);
    }
  }

  // Navigation au clic (maintenir le comportement existant)
  if (item.goto) {
    base.addEventListener('click', () => { window.location.search='?page='+item.goto; });
    if (hover) hover.addEventListener('click', () => { window.location.search='?page='+item.goto; });
    if (oEl) oEl.addEventListener('click', () => { window.location.search='?page='+item.goto; });
  }

  if (item.gotoPrev) {
    base.addEventListener('click', () => { window.location.search='?page='+item.gotoPrev; });
  }
});

if (currentPage === 11) {
  const container = document.querySelector('#container');

  const imagesSlider = [
    { base: "images/1.png", hover: "images/11t.png" },
    { base: "images/2.png", hover: "images/21.png" },
    { base: "images/3.png", hover: "images/31.png" },
    { base: "images/4.png", hover: "images/41.png" },
    { base: "images/5.png", hover: "images/51.png" },
    { base: "images/6.png", hover: "images/61.png" },
    { base: "images/7.png", hover: "images/71.png" },
    { base: "images/8.png", hover: "images/81.png" },
    { base: "images/9.png", hover: "images/91.png" },
    { base: "images/10.png", hover: "images/101.png" }
  ];

  // --- Variables modifiables ---
  const wrapperWidth = 1400;  // largeur de la fenêtre visible
  const wrapperHeight = 500; // hauteur de la fenêtre visible
  const imageWidth = 300;    // largeur des images
  const imageHeight = 400;   // hauteur des images
  const gap = 100;            // espace entre images
  const imagesPerRow = 3;    // nombre d'images par ligne
  const visibleRows = 1;     // nombre de lignes visibles

  // --- Conteneur visible ---
  const sliderWrapper = document.createElement('div');
  sliderWrapper.style.position = 'absolute';
  sliderWrapper.style.top = '330px';
  sliderWrapper.style.left = '452px';
  sliderWrapper.style.width = `${wrapperWidth}px`;
  sliderWrapper.style.height = `${wrapperHeight}px`;
  sliderWrapper.style.overflow = 'hidden';
  container.appendChild(sliderWrapper);

  const sliderTrack = document.createElement('div');
  sliderTrack.style.display = 'flex';
  sliderTrack.style.flexDirection = 'column';
  sliderTrack.style.transition = 'transform 0.5s ease';
  sliderWrapper.appendChild(sliderTrack);

  const rowCount = Math.ceil(imagesSlider.length / imagesPerRow);

  // --- Création des lignes ---
  for (let i = 0; i < rowCount; i++) {
    const row = document.createElement('div');
    row.style.display = 'flex';
    row.style.gap = `${gap}px`;
    row.style.marginBottom = `${gap}px`;

    for (let j = 0; j < imagesPerRow; j++) {
      const index = i * imagesPerRow + j;
      if (index >= imagesSlider.length) break;

      const imgObj = imagesSlider[index];
      const slide = document.createElement('div');
      slide.style.position = 'relative';
      slide.style.width = `${imageWidth}px`;
      slide.style.height = `${imageHeight}px`;

      // Image de base
      const img = document.createElement('img');
      img.src = imgObj.base;
      img.style.width = `${imageWidth}px`;
      img.style.height = `${imageHeight}px`;
      img.style.cursor = 'pointer';
      slide.appendChild(img);

      // Image hover
      const hover = document.createElement('img');
      hover.src = imgObj.hover;
      hover.style.position = 'absolute';
      hover.style.top = '0';
      hover.style.left = '0';
      hover.style.width = `${imageWidth}px`;
      hover.style.height = `${imageHeight}px`;
      hover.style.display = 'none';
      slide.appendChild(hover);

// Survol : l'image de base disparaît, hover apparaît
slide.addEventListener('mouseenter', () => {
    img.style.display = 'none';   // cacher l'image de base
    hover.style.display = 'block'; // afficher le hover
});
slide.addEventListener('mouseleave', () => {
    hover.style.display = 'none';  // cacher le hover
    img.style.display = 'block';   // remettre l'image de base
});


      row.appendChild(slide);
    }

    sliderTrack.appendChild(row);
  }

  let currentIndex = 0;

  // --- Flèches ---
  const btnUp = document.createElement('img');
  btnUp.src = "images/boutona.png";
  btnUp.style.position = 'absolute';
  btnUp.style.left = '152px';
  btnUp.style.top = '300px';
  btnUp.style.cursor = 'pointer';
  container.appendChild(btnUp);

  const btnDown = document.createElement('img');
  btnDown.src = "images/boutonb.png";
  btnDown.style.position = 'absolute';
  btnDown.style.left = '132px';
  btnDown.style.top = '640px';
  btnDown.style.cursor = 'pointer';
  container.appendChild(btnDown);

  function updateSlider() {
    const firstRow = sliderTrack.children[currentIndex];
    const rowHeight = firstRow ? firstRow.offsetHeight + gap : 0;
    sliderTrack.style.transform = `translateY(-${currentIndex * rowHeight}px)`;
    btnUp.style.display = currentIndex === 0 ? 'none' : 'block';
    btnDown.style.display = currentIndex + visibleRows >= rowCount ? 'none' : 'block';
  }

  btnUp.addEventListener('click', () => {
    if (currentIndex > 0) currentIndex--;
    updateSlider();
  });

  btnDown.addEventListener('click', () => {
    if (currentIndex + visibleRows < rowCount) currentIndex++;
    updateSlider();
  });

  updateSlider();
}


// === Audio et navigation pour pages 6 à 9 ===
if(currentPage >= 6 && currentPage <= 9){
  // Coordonnées et fichiers
  const playImages = [
    { page: 6, img: "images/play1.png", imgBis: "images/play1bis.png", audio: "audio1.mp3" },
    { page: 7, img: "images/play2.png", imgBis: "images/play2bis.png", audio: "audio2.mp3" },
    { page: 8, img: "images/play3.png", imgBis: "images/play3bis.png", audio: "audio3.mp3" },
    { page: 9, img: "images/play4.png", imgBis: "images/play4bis.png", audio: "audio4.mp3" },
  ];

  const rImages = [
    { page: 6, img: "images/r1.png", goto: 2 },
    { page: 7, img: "images/r2.png", goto: 3 },
    { page: 8, img: "images/r3.png", goto: 4 },
    { page: 9, img: "images/r4.png", goto: 5 },
  ];

  // Création de l'image play et audio
  const playItem = playImages.find(p => p.page === currentPage);
  if(playItem){
    const audio = new Audio(playItem.audio);
    const playImg = document.createElement('img');
    playImg.src = playItem.img;
    playImg.classList.add('img-item');
    playImg.style.left = '1318.1171px';
    playImg.style.top = '393.2345px';
    playImg.style.zIndex = 5;
    playImg.style.cursor = 'pointer';
    container.appendChild(playImg);

    let isPlaying = false;
    playImg.addEventListener('click', () => {
      if(!isPlaying){
        audio.play();
        playImg.src = playItem.imgBis;
        isPlaying = true;
      } else {
        audio.pause();
        audio.currentTime = 0;
        playImg.src = playItem.img;
        isPlaying = false;
      }
    });
  }

  // Création de l'image r (retour)
  const rItem = rImages.find(r => r.page === currentPage);
  if(rItem){
    const rImg = document.createElement('img');
    rImg.src = rItem.img;
    rImg.classList.add('img-item');
    rImg.style.left = '1500.3523px';
    rImg.style.top = '393.2345px';
    rImg.style.zIndex = 5;
    rImg.style.cursor = 'pointer';
    container.appendChild(rImg);

    rImg.addEventListener('click', () => {
      window.location.search = '?page=' + rItem.goto;
    });
  }
}


// Redimension adaptatif
function resizeContainer() {
  const scale = Math.min(window.innerWidth / 1920, window.innerHeight / 1080);
  container.style.transform = `translate(-50%, -50%) scale(${scale})`;
}
window.addEventListener('resize', resizeContainer);
resizeContainer();
// === Images supplémentaires pour les pages 6 à 13 ===
const imagesAAjouter = [


  // Page 10


  // Page 11
 
  // Page 12


  // Page 13
  { base:"images/notice.png", x:931.9288, y:70.1469, z:2, pages:[13]}
 
];

// === Génération des images ===
imagesAAjouter.forEach(item => {
  if (!item.pages.includes(currentPage)) return;

  const img = document.createElement('img');
  img.src = item.base;
  img.classList.add('img-item');
  img.style.left = item.x + 'px';
  img.style.top = item.y + 'px';
  img.style.zIndex = item.z;
  if (item.width) img.style.width = item.width + 'px';
  if (item.height) img.style.height = item.height + 'px';

  container.appendChild(img);
});


// === Slider pour la page 12 ===
if(currentPage === 12){
  const sliderImages = [
     "images/120.png",
    "images/121.png",
    "images/122.png",
    "images/123.png",
    "images/124.png",
    "images/125.png"
  ];
  let currentIndex = 0;

  // Image du slider
  const img = document.createElement('img');
  img.src = sliderImages[currentIndex];
  img.classList.add('img-item');
  img.style.left = '982.42px';
  img.style.top = '514.69px';
  img.style.zIndex = 2;
  container.appendChild(img);

  // Bouton précédent
  const btnG = document.createElement('img');
  btnG.src = "images/boutong.png";
  btnG.classList.add('img-item');
  btnG.style.left = '664.297px';
  btnG.style.top = '985.8503px';
  btnG.style.cursor = 'pointer';
  btnG.style.zIndex = 5;
  container.appendChild(btnG);

  // Bouton suivant
  const btnD = document.createElement('img');
  btnD.src = "images/boutond.png";
  btnD.classList.add('img-item');
  btnD.style.left = '1055.4581px';
  btnD.style.top = '985.8503px';
  btnD.style.cursor = 'pointer';
  btnD.style.zIndex = 5;
  container.appendChild(btnD);

function updateSliderButtons() {
  // Si on est à la première image → cacher bouton gauche
  if(currentIndex === 0){
    btnG.style.display = 'none';
    btnD.style.display = 'block';
  }
  // Si on est à la dernière image → cacher bouton droit
  else if(currentIndex === sliderImages.length - 1){
    btnD.style.display = 'none';
    btnG.style.display = 'block';
  }
  // Sinon → afficher les deux
  else {
    btnG.style.display = 'block';
    btnD.style.display = 'block';
  }
}

// Initialisation
updateSliderButtons();

btnD.addEventListener('click', () => {
  if(currentIndex < sliderImages.length - 1){
    currentIndex++;
    img.src = sliderImages[currentIndex];
    updateSliderButtons();
  }
});

btnG.addEventListener('click', () => {
  if(currentIndex > 0){
    currentIndex--;
    img.src = sliderImages[currentIndex];
    updateSliderButtons();
  }
});

}
// === Bouton d'inversion ===
const invertToggle = document.createElement('img');
invertToggle.src = "images/inverser.png";
invertToggle.classList.add('img-item', 'no-invert'); // on marque le toggle tout de suite
invertToggle.style.left = '406.8128px';
invertToggle.style.top = '59.1281px';
invertToggle.style.zIndex = 4;
invertToggle.style.cursor = 'pointer';
invertToggle.id = 'invertToggle';
container.appendChild(invertToggle);

// === Liste des images à ne jamais inverser (noms de fichier) ===
const imagesNoInvert = [
  "boite9.png","boite6.png","boite7.png","boite8.png",
  "k72.png","k73.png","k74.png","k75.png",
  "nu9.png","nu6.png","nu7.png","nu8.png",
  "milvi.png","lowtechlab.png","drid.png","fungilab.png",
  "milvi1.png","lowtechlab1.png","drid1.png","fungilab1.png",
  "b1.png","b2.png","flab.png",
  "inverser.png","inverser1.png","am.png","bm.png","cm.png","dm.png","b1bis.png","b2bis.png","fex1.png","fex2.png","fex3.png","fex4.png","p81.png","p82.png","p83.png",
];

// Fonction utilitaire : marque toutes les .img-item existantes qui correspondent
function markNoInvert() {
  document.querySelectorAll('.img-item').forEach(img => {
    // protection : certaines images peuvent avoir src vide au moment de l'ajout
    if (!img.src) return;
    const filename = img.src.split('/').pop();
    if (imagesNoInvert.includes(filename)) {
      // ajoute la classe si elle n'existe pas encore
      if (!img.classList.contains('no-invert')) img.classList.add('no-invert');
    }
  });
}
// appel initial (pour les images déjà présentes)
markNoInvert();

// observe le container pour attraper les images ajoutées plus tard
const mo = new MutationObserver((mutations) => {
  let changed = false;
  for (const m of mutations) {
    if (m.type === 'childList' && m.addedNodes.length) {
      changed = true;
      break;
    }
  }
  if (changed) markNoInvert();
});
mo.observe(container, { childList: true, subtree: true });

// === Gestion de l’état du mode inversé (persistant entre les pages) ===
let invertedState = localStorage.getItem('inverted') || '1'; // 1 = inversé par défaut

// Transition fluide sur rotation et position
invertToggle.style.transition = "transform 0.6s ease, left 0.6s ease, top 0.6s ease";

// Appliquer l’état actuel au chargement
function applyInvertState() {
  if (invertedState === '1') {
    document.body.classList.add('inverted');
    invertToggle.style.left = '456.8128px';
    invertToggle.style.top = '59.1281px';
    invertToggle.style.transform = "translate(-50%, -50%) rotate(180deg)";
  } else {
    document.body.classList.remove('inverted');
    invertToggle.style.left = '406.8128px'; // position normale
    invertToggle.style.top = '59.1281px';
    invertToggle.style.transform = "translate(-50%, -50%) rotate(0deg)";
  }
}

// Appliquer dès le chargement
applyInvertState();

// Gestion du clic sur le bouton (persistant)
invertToggle.addEventListener('click', () => {
  invertedState = (invertedState === '1') ? '0' : '1';
  localStorage.setItem('inverted', invertedState);
  applyInvertState();
});

// === Effet de survol pour detail.png avec goto dynamique ===
window.addEventListener('load', () => {
  document.querySelectorAll('img[src$="detail.png"]').forEach(detailImg => {
    const hoverImg = document.createElement('img');
    hoverImg.src = 'images/detail1.png';
    hoverImg.classList.add('img-item');
    hoverImg.style.left = detailImg.style.left;
    hoverImg.style.top = detailImg.style.top;
    hoverImg.style.zIndex = (parseInt(detailImg.style.zIndex) || 4) + 1;
    hoverImg.style.display = 'none';
    hoverImg.style.opacity = 0;
    hoverImg.style.transition = 'opacity 0s ease';
    detailImg.parentNode.appendChild(hoverImg);

    // Récupère l'élément data correspondant à cette image detail.png
    const filename = detailImg.src.split('/').pop();
    const dataItem = data.find(d => d.base.endsWith(filename) && d.pages.includes(currentPage));

    detailImg.addEventListener('mouseenter', () => {
      hoverImg.style.display = 'block';
      requestAnimationFrame(() => hoverImg.style.opacity = 1);
    });

    detailImg.addEventListener('mouseleave', (e) => {
      if (e.relatedTarget !== hoverImg) {
        hoverImg.style.opacity = 0;
        setTimeout(() => hoverImg.style.display = 'none', 300);
      }
    });

    hoverImg.addEventListener('mouseenter', () => {
      hoverImg.style.display = 'block';
      hoverImg.style.opacity = 1;
    });
    hoverImg.addEventListener('mouseleave', () => {
      hoverImg.style.opacity = 0;
      setTimeout(() => hoverImg.style.display = 'none', 300);
    });

    // === Gestion du clic vers goto si défini ===
    if (dataItem && dataItem.goto) {
      hoverImg.style.cursor = 'pointer';
      hoverImg.addEventListener('click', () => {
        window.location.search = '?page=' + dataItem.goto;
      });
    }
  });
});
if (currentPage === 13) {
  const sliderImagesAccueil = [
    "images/i1.png",
    "images/i2.png",
    "images/i3.png",
    "images/i4.png",
  ];
  let currentIndexAccueil = 0;

  // Image du slider
  const imgAccueil = document.createElement('img');
  imgAccueil.src = sliderImagesAccueil[currentIndexAccueil];
  imgAccueil.classList.add('img-item');
  imgAccueil.style.position = 'absolute';
  imgAccueil.style.left = '1000px';
  imgAccueil.style.top = '510px';
  imgAccueil.style.objectFit = 'cover';
  imgAccueil.style.zIndex = '990';
  container.appendChild(imgAccueil);

  // Flèches
  const btnGA = document.createElement('img');
  btnGA.src = "images/boutong.png";
  btnGA.style.position = 'absolute';
  btnGA.style.left = '660px';
  btnGA.style.top = '10px';
  btnGA.style.cursor = 'pointer';
  btnGA.style.zIndex = '1001';
  container.appendChild(btnGA);

  const btnDA = document.createElement('img');
  btnDA.src = "images/boutond.png";
  btnDA.style.position = 'absolute';
  btnDA.style.left = '1100px';
  btnDA.style.top = '40px';
  btnDA.style.cursor = 'pointer';
  btnDA.style.zIndex = '1001';
  container.appendChild(btnDA);

  // === Zone de survol limitée + bouton ===
  const hoverZone = document.createElement('div');
  hoverZone.style.position = 'absolute';
  hoverZone.style.left = '865px';
  hoverZone.style.top = '370px';
  hoverZone.style.width = '200px';
  hoverZone.style.height = '200px';
  hoverZone.style.cursor = 'pointer';
  hoverZone.style.background = 'transparent';
  hoverZone.style.zIndex = '1001';
  container.appendChild(hoverZone);

  const btnParti = document.createElement('img');
  btnParti.src = "images/parti1.png";
  btnParti.style.position = 'absolute';
  btnParti.style.left = '965px';
  btnParti.style.top = '470px';
  btnParti.style.transform = 'translate(-50%, -50%)';
  btnParti.style.cursor = 'pointer';
  btnParti.style.zIndex = '1002';
  btnParti.style.display = 'none';
  container.appendChild(btnParti);

  // Affichage uniquement quand on survole la zone
  hoverZone.addEventListener('mouseenter', () => {
    if (currentIndexAccueil === sliderImagesAccueil.length - 1) { // seulement dernière image
      btnParti.style.display = 'block';
    }
  });
  hoverZone.addEventListener('mouseleave', () => {
    btnParti.style.display = 'none';
  });

  btnParti.addEventListener('click', () => {
    window.location.search = '?page=1';
  });

  // Fonction de mise à jour du slider
  function updateSliderAccueil() {
    imgAccueil.src = sliderImagesAccueil[currentIndexAccueil];
    btnParti.style.display = 'none';
    btnGA.style.display = (currentIndexAccueil === 0) ? 'none' : 'block';
    btnDA.style.display = (currentIndexAccueil === sliderImagesAccueil.length - 1) ? 'none' : 'block';
  }

  btnDA.addEventListener('click', () => {
    if (currentIndexAccueil < sliderImagesAccueil.length - 1) {
      currentIndexAccueil++;
      updateSliderAccueil();
    }
  });
  btnGA.addEventListener('click', () => {
    if (currentIndexAccueil > 0) {
      currentIndexAccueil--;
      updateSliderAccueil();
    }
  });

  updateSliderAccueil();
}
if (currentPage === 10) {
  const sliderImagesAccueil = [
     "images/st0.png",
    "images/st1.png",
    "images/st2.png",
    "images/st3.png",
    "images/st4.png",
    "images/st5.png",
    "images/st6.png",
  ];
  let currentIndexAccueil = 0;

  // Image du slider
  const imgAccueil = document.createElement('img');
  imgAccueil.src = sliderImagesAccueil[currentIndexAccueil];
  imgAccueil.classList.add('img-item');
  imgAccueil.style.position = 'absolute';
  imgAccueil.style.left = '1000px';
  imgAccueil.style.top = '550px';
  imgAccueil.style.objectFit = 'cover';
  imgAccueil.style.zIndex = '990';
  container.appendChild(imgAccueil);

  // Flèches
  const btnGA = document.createElement('img');
  btnGA.src = "images/boutonb.png";
  btnGA.style.position = 'absolute';
  btnGA.style.left = '1680.34px';
  btnGA.style.top = '630px';
  btnGA.style.cursor = 'pointer';
  btnGA.style.zIndex = '1001';
  container.appendChild(btnGA);

  const btnDA = document.createElement('img');
  btnDA.src = "images/boutona.png";
  btnDA.style.position = 'absolute';
  btnDA.style.left = '1690.34px';
  btnDA.style.top = '298.95px';
  btnDA.style.cursor = 'pointer';
  btnDA.style.zIndex = '1001';
  container.appendChild(btnDA);

  // === Zone de survol limitée + bouton ===
  const hoverZone = document.createElement('div');
  hoverZone.style.position = 'absolute';
  hoverZone.style.left = '865px';
  hoverZone.style.top = '370px';
  hoverZone.style.width = '200px';
  hoverZone.style.height = '200px';
  hoverZone.style.cursor = 'pointer';
  hoverZone.style.background = 'transparent';
  hoverZone.style.zIndex = '1001';
  container.appendChild(hoverZone);

  const btnParti = document.createElement('img');
  btnParti.src = "images/parti1.png";
  btnParti.style.position = 'absolute';
  btnParti.style.left = '10000px';
  btnParti.style.top = '470px';
  btnParti.style.transform = 'translate(-50%, -50%)';
  btnParti.style.cursor = 'pointer';
  btnParti.style.zIndex = '1002';
  btnParti.style.display = 'none';
  container.appendChild(btnParti);

  // Affichage uniquement quand on survole la zone
  hoverZone.addEventListener('mouseenter', () => {
    if (currentIndexAccueil === sliderImagesAccueil.length - 1) { // seulement dernière image
      btnParti.style.display = 'block';
    }
  });
  hoverZone.addEventListener('mouseleave', () => {
    btnParti.style.display = 'none';
  });

  btnParti.addEventListener('click', () => {
    window.location.search = '?page=1';
  });

  // Fonction de mise à jour du slider
  function updateSliderAccueil() {
    imgAccueil.src = sliderImagesAccueil[currentIndexAccueil];
    btnParti.style.display = 'none';
    btnGA.style.display = (currentIndexAccueil === 0) ? 'none' : 'block';
    btnDA.style.display = (currentIndexAccueil === sliderImagesAccueil.length - 1) ? 'none' : 'block';
  }

  btnDA.addEventListener('click', () => {
    if (currentIndexAccueil < sliderImagesAccueil.length - 1) {
      currentIndexAccueil++;
      updateSliderAccueil();
    }
  });
  btnGA.addEventListener('click', () => {
    if (currentIndexAccueil > 0) {
      currentIndexAccueil--;
      updateSliderAccueil();
    }
  });

  updateSliderAccueil();
}


// ✅ CONFIGURATION DES SLIDERS PAR PAGE
const slidersConfig = {
  6: {
    imagesBaseVisibles: [
      "fond.png", "titre6.png", "texte6.png"
    ],
    slidersData: {
      "p6s1.png": [
        "images/p6s1_1.png",
        "images/p6s1_2.png",
        "images/p6s1_3.png",
      ],
      "p6s2.png": [
        "images/p6s2_1.png",
        "images/p6s2_2.png",
      ],
    },
    imagesNonInversees: [
      "images/p6s1_2.png", "images/p6s2_1.png"
    ]
  },

  7: {
    imagesBaseVisibles: [
      "fond.png", "titre7.png", "texte7.png"
    ],
    slidersData: {
      "p7s1.png": [
        "images/p7s1_1.png",
        "images/p7s1_2.png",
      ]
    },
    imagesNonInversees: []
  },

  8: {
    imagesBaseVisibles: [
     "fond.png",
      "homme.png",
      "livre.png",
      "point.png",
      "portfolio1.png",
      "inverser.png",
    ],
    slidersData: {
      "p81.png": [
        "images/p811.png",
        "images/p812.png",
        "images/p813.png",
        "images/p814.png",
        "images/p815.png",
      ],
      "p82.png": [
        "images/p821.png",
        "images/p822.png",
        "images/p823.png",
        "images/p824.png",
        "images/p825.png",
        "images/p826.png",
        "images/p827.png",
      ],
      "p83.png": [
        "images/p831.png",
        "images/p832.png",
        "images/p833.png",
        "images/p834.png",
        "images/p836.png",
        "images/p837.png",
        "images/p838.png",
      ],

    },
    imagesNonInversees: [
      "images/p811.png",
      "images/p812.png",
      "images/p813.png",
      "images/p814.png",
       "images/p815.png",
      
      "images/p821.png",
      "images/p822.png",
      "images/p823.png",
      "images/p824.png",
      "images/p825.png",
      "images/p826.png",
      "images/p827.png",

      "images/p831.png",
      "images/p833.png",
      "images/p834.png",
      "images/p836.png",
      "images/p837.png",
      "images/p838.png",
    ]
  },

  9: {
    imagesBaseVisibles: [
      "fond.png",
      "homme.png",
      "livre.png",
      "point.png",
      "portfolio1.png",
      "inverser.png",
    ],
    slidersData: {
      "p9s1.png": [
        "images/p9s1bis.png",
        "images/f1r.png",
        "images/f2r.png",
        "images/f3r.png",
        "images/f4r.png",
        "images/f5r.png",
        "images/f6r.png",
        "images/f7r.png",
      ],
      "flab.png": [
        "images/flab1.png",
        "images/fex1.png",
        "images/fex2.png",
        "images/fex3.png",
        "images/fex4.png",
      ],
      "lowtech.png": [
        "images/low1.png",
        "images/low2.png",
        "images/low3.png",
      ],
    },
    imagesNonInversees: [
      "images/f1r.png",
      "images/f2r.png",
      "images/f3r.png",
      "images/f4r.png",
      "images/f5r.png",
      "images/f6r.png",
      "images/f7r.png",
      "images/flab1.png",
      "images/fex1.png",
      "images/fex2.png",
      "images/fex3.png",
      "images/fex4.png",

      
      
    ]
  }
};

// ⚙️ Active le slider si la page actuelle est configurée
if (slidersConfig[currentPage]) {
  const { imagesBaseVisibles, slidersData, imagesNonInversees } = slidersConfig[currentPage];
  setupSliderForPage({ pageNumber: currentPage, imagesBaseVisibles, slidersData, imagesNonInversees });
}

// 🧠 Fonction principale du slider (réutilisable pour toutes les pages)
function setupSliderForPage({ pageNumber, imagesBaseVisibles, slidersData, imagesNonInversees }) {
  const container = document.getElementById('container');
  if (!container) return;

  // --- Création du container slider ---
  const sliderContainer = document.createElement('div');
  Object.assign(sliderContainer.style, {
    position: 'absolute',
    left: '0', top: '0',
    width: '100%', height: '100%',
    zIndex: '1000',
    display: 'none',
  });
  container.appendChild(sliderContainer);

  // --- Image principale ---
  const sliderImg = document.createElement('img');
  Object.assign(sliderImg.style, {
    position: 'absolute',
    left: '982px',
    top: '540px',
    transform: 'translate(-50%, -50%)',
    zIndex: '1',
  });
  sliderContainer.appendChild(sliderImg);

  // --- Boutons navigation ---
  const btnG = document.createElement('img');
  btnG.src = "images/boutong.png";
  Object.assign(btnG.style, {
    position: 'absolute',
    left: '350px',
    top: '540px',
    cursor: 'pointer',
     zIndex: '1000',
    transform: 'translateY(-50%)',
  });
  sliderContainer.appendChild(btnG);

  const btnD = document.createElement('img');
  btnD.src = "images/boutond.png";
  Object.assign(btnD.style, {
    position: 'absolute',
    left: '1490px',
    top: '540px',
    cursor: 'pointer',
    zIndex: '1000',
    transform: 'translateY(-50%)',
  });
  sliderContainer.appendChild(btnD);

  const closeBtn = document.createElement('img');
  closeBtn.src = "images/retour.png";
  Object.assign(closeBtn.style, {
    position: 'absolute',
    left: '1550px',
    top: '30px',
    cursor: 'pointer',
  });
  sliderContainer.appendChild(closeBtn);

  document.querySelectorAll('.img-item').forEach(img => {
    img.style.transition = 'opacity 0.3s ease';
  });

  function cacherImagesPourSlider() {
    document.querySelectorAll('.img-item').forEach(img => {
      const filename = img.src.split('/').pop();
      if (!imagesBaseVisibles.includes(filename)) {
        img.style.opacity = 0;
        img.style.pointerEvents = 'none';
      }
    });
  }

  function restaurerImagesApresSlider() {
    document.querySelectorAll('.img-item').forEach(img => {
      img.style.opacity = 1;
      img.style.pointerEvents = 'auto';
    });
  }

  let currentSlider = [];
  let currentIndex = 0;

  function updateSlider() {
    const currentImage = currentSlider[currentIndex];
    sliderImg.src = currentImage;

    if (imagesNonInversees.includes(currentImage)) {
      sliderImg.classList.add('no-invert');
    } else {
      sliderImg.classList.remove('no-invert');
    }

    btnG.style.display = currentIndex === 0 ? 'none' : 'block';
    btnD.style.display = currentIndex === currentSlider.length - 1 ? 'none' : 'block';
  }

  btnG.addEventListener('click', () => {
    if (currentIndex > 0) {
      currentIndex--;
      updateSlider();
    }
  });

  btnD.addEventListener('click', () => {
    if (currentIndex < currentSlider.length - 1) {
      currentIndex++;
      updateSlider();
    }
  });

  closeBtn.addEventListener('click', () => {
    sliderContainer.style.display = 'none';
    restaurerImagesApresSlider();
  });

  Object.keys(slidersData).forEach(triggerName => {
    const triggerImg = document.querySelector(`img[src$="${triggerName}"]`);
    if (triggerImg) {
      triggerImg.addEventListener('click', () => {
        cacherImagesPourSlider();
        sliderContainer.style.display = 'block';
        currentSlider = slidersData[triggerName];
        currentIndex = 0;
        updateSlider();
      });
    }
  });
}




// Liste des images cliquables et de leurs agrandissements
const imageLinks = {
  "images/p6s1.png": "images/p6s1bis.png",
  "images/p6s2.png": "images/p6s2bis.png",
  "images/p6s3.png": "images/p6s3bis.png",
  "images/p6s4.png": "images/p6s4bis.png",
  "images/p6s5.png": "images/p6s5bis.png",

  "images/p7s1.png": "images/p7s1bis.png",
  "images/p7s2.png": "images/p7s2bis.png",
  "images/p7s3.png": "images/p7s3bis.png",
  "images/b0.png": "images/b0bis1.png",
  "images/b1.png": "images/b1bis.png",
  "images/b2.png": "images/b2bis.png",


  "images/p8_.png": "images/p8_zoom.png",
  "images/p9s2.png": "images/p9s2bis.png"
};

// Images à garder visibles
const keepVisible = [
  "fond.png",
  "homme.png",
  "livre.png",
  "point.png",
  "portfolio.png",
  "inverser.png"
];

function showPopup(triggerSrc, popupSrc) {
  // Cache les images non-keepVisible
  document.querySelectorAll('.img-item').forEach(img => {
    const filename = img.src.split('/').pop();
    if (!keepVisible.includes(filename)) {
      img.style.opacity = 0;
      img.style.pointerEvents = 'none';
    }
  });

  // Création container pour popup
  const overlay = document.createElement('div');
  overlay.style.position = 'absolute';
  overlay.style.top = '0';
  overlay.style.left = '0';
  overlay.style.width = '100%';
  overlay.style.height = '100%';
  overlay.style.zIndex = '900'; // sous les images "retour"
  overlay.style.display = 'flex';
  overlay.style.alignItems = 'center';
  overlay.style.justifyContent = 'center';
  container.appendChild(overlay); // append au container principal

  // Image popup
  const popupImg = document.createElement('img');
  popupImg.src = popupSrc;
  popupImg.classList.add('img-item'); // même comportement que les autres images
  popupImg.style.left = '50%';
  popupImg.style.top = '50%';
  popupImg.style.transform = 'translate(-50%, -50%)';
  overlay.appendChild(popupImg);

  // Bouton retour comme une image normale
  const closeBtn = document.createElement('img');
  closeBtn.src = "images/retour.png";
  closeBtn.classList.add('img-item');  // ✅ se comporte comme tes autres images
  closeBtn.style.left = '1600px';      // tu peux modifier ces valeurs comme pour fond.png
  closeBtn.style.top = '60px';
  closeBtn.style.cursor = 'pointer';
  closeBtn.style.zIndex = '1000';      // au-dessus du popup
  container.appendChild(closeBtn);     // append au container principal

  // Fermeture au clic
  closeBtn.addEventListener('click', () => {
    overlay.remove();
    closeBtn.remove();
    document.querySelectorAll('.img-item').forEach(img => {
      img.style.opacity = 1;
      img.style.pointerEvents = 'auto';
    });
  });
}

// Activation sur les pages 6-7-8-9
if ([6, 7, 8, 9].includes(currentPage)) {
  Object.entries(imageLinks).forEach(([triggerSrc, popupSrc]) => {
    const imgTrigger = document.querySelector(`img[src="${triggerSrc}"]`);
    if (!imgTrigger) return;
    imgTrigger.style.cursor = 'pointer';
    imgTrigger.addEventListener('click', () => showPopup(triggerSrc, popupSrc));
  });

}

function showPopup(triggerSrc, popupSrc) {
  // Cache les images non-keepVisible
  document.querySelectorAll('.img-item').forEach(img => {
    const filename = img.src.split('/').pop();
    if (!keepVisible.includes(filename)) {
      img.style.opacity = 0;
      img.style.pointerEvents = 'none';
    }
  });

  // Création du container pour le popup
  const overlay = document.createElement('div');
  overlay.style.position = 'absolute';
  overlay.style.top = '0';
  overlay.style.left = '0';
  overlay.style.width = '100%';
  overlay.style.height = '100%';
  overlay.style.zIndex = '900';
  overlay.style.display = 'flex';
  overlay.style.alignItems = 'center';
  overlay.style.justifyContent = 'center';
  container.appendChild(overlay);

  // Image popup
  const popupImg = document.createElement('img');
  popupImg.src = popupSrc;
  popupImg.classList.add('img-item');
  popupImg.style.left = '50%';
  popupImg.style.top = '50%';
  popupImg.style.transform = 'translate(-50%, -50%)';
  popupImg.style.cursor = 'pointer'; // important si c'est cliquable
  overlay.appendChild(popupImg);

  // 🔗 Liens externes (seulement pour les images agrandies)
  const externalLinks = {
    "b1bis.png": "https://wiki.lowtechlab.org/wiki/Sciences_Participatives_:_Bioponie_d%27int%C3%A9rieur",
    "b2bis.png": "https://wiki.lowtechlab.org/wiki/Sciences_Participatives_:_Elevage_de_grillons_comestibles",
    "b0bis.png": "https://biosphere-experience.org",
  };

  const popupFilename = popupSrc.split('/').pop();
  if (externalLinks[popupFilename]) {
    popupImg.addEventListener('click', () => {
      window.open(externalLinks[popupFilename], '_blank');
    });
  }

  // Bouton retour
  const closeBtn = document.createElement('img');
  closeBtn.src = "images/retour.png";
  closeBtn.classList.add('img-item');
  closeBtn.style.left = '1600px';
  closeBtn.style.top = '70px';
  closeBtn.style.cursor = 'pointer';
  closeBtn.style.zIndex = '1000';
  container.appendChild(closeBtn);

  // Fermeture au clic
  closeBtn.addEventListener('click', () => {
    overlay.remove();
    closeBtn.remove();
    document.querySelectorAll('.img-item').forEach(img => {
      img.style.opacity = 1;
      img.style.pointerEvents = 'auto';
    });
  });
}




</script>

</body>
</html>
